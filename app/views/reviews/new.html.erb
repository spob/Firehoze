<% title "Write a review for &quot;#{h(@lesson.title)}&quot;" -%>

<%= render :partial => "shared/infield_head_content" %>
<%= stylesheet 'validation' %>
<%= javascript 'jquery.simplyCountable', 'validate/jquery.validate', 'validate/review.validate' %>

<% form_for(:review, :url => lesson_reviews_url(@lesson), :html => { :class => "review", :id => "review" }) do |f| %>
<%= f.error_messages %>
<fieldset>
  <legend>Write a review for: <%= link_to h(@lesson.title), lesson_path(@lesson) %></legend>

  <div id="rating_container">
    <%= lesson_rating_for(@lesson, current_user) -%>
    <div id="rating_average">Average Rating: <span id="<%= dom_id(@lesson) -%>_average" class="average"><%= current_average(@lesson) -%></span> (<span id="<%= dom_id(@lesson) -%>_count"><%= vote_counts_phrase(@lesson) -%></span>)</div>
  </div>

  <p>
    <%= f.label :headline %><br />
    <%= f.text_field :headline, :maxlength => "100", :class => "required" %>
    <div class="counter"><span id="headline_counter"></span> characters left</div>
  </p>

  <p>
    <%= f.label :body %><br />
    <%= f.text_area :body, :class => "required" %>
    <span class="help">(Format using *<b>bold</b>* and _<i>italics</i>_ text)</span>
  </p>
</fieldset>

<p>
  <%= f.submit "Create review", :class => "submit" %>
  <%= link_to "Cancel", lesson_path(@lesson) %>
</p>
<% end %>
